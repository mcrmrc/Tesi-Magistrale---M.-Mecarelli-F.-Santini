%Una volta configurato, si è proceduto a testare se RITA fosse in grado di rilevare i Covert Channel implementati. 
Per potr verificare se RITA fosse in grado di rilevare i Covert Channel implementati, 
si sono effettuati diversi test. 
RITA ha analizzato i log di Zeek generati usando la sua configurazione di default. 
%\vspace{2ex} \newline
%Nel primo si è usato un documento dal quale è stato esfiltrato il testo. 
%Il testo è stato ricavato 
%tramite il modulo \textit{PdfReader} della libreria \textbf{pypdf}. 
%Per ogni pagina si è quindi estratto il testo in essa e lo si è poi esfiltrato 
%tramite i Covert Channel implementati.
\vspace{1ex} \newline 
%Il file contiene delle linee guida sull'utilizzo e la conservazione delle password. 
%\uppercase{è} un file di diciannove pagine la cui dimensione è 3.5 MB. 
%La prima riga è con i risultati di default, l'altra con la configurazione modificata 
Nel \textbf{primo test} si è esfiltrato un file di testo contenente una quantità di dati pari a \textbf{37 KB}.
%In totale la \textbf{quantità di dati mandati} sono 37201 bytes che sono all'incirca \textbf{37 KB} 
Inoltre fra l'invio di un pacchetto e quello successivo si ha un \textbf{delay} in media di \textbf{2 secondi}. 
%L'invio di questi dati è stato interato per quattro volte. 
\vspace{2ex} \newline  
Dai risultati [Tabella \ref{tab:test1:rita_icmp:rilevati}] si ricava che alla maggior parte dei Covert Channel 
viene assegnata una gravità bassa e un tasso di beaconing dello 0\%. 
Ciò significa che l'esfiltrazione non ha destato sospetti, sebbene lo scambio di dati sia stato comunque rilevato. 
I motivi della gravità bassa sono dati dalla qunatità bassa di dati esfiltrati mentre il livello di beaconing è 
derivato dal fatto che la richiesta dei dati (e il loro invio) è stata fatta poche volte. 
\vspace{1ex} \newline
Fra questi test, un eccezzione è il \textit{Covert Channel Ibrido} nel quale risulta un tasso di beacon del 
85.4\% e un alto tasso di gravità. 
\vspace{1ex} \newline
Un ulteriore eccezzione è il \textit{Covert Channel Echo} che utilizza i campi del messaggio ed il payload. 
Non risulta alcun dato perchè il tempo è stato troppo breve. %(30 secondi). 
\begin{center} 
\begin{longtable}{|c|c|c|c|} 
    \hline
    \textbf{Covert Channel} & \multicolumn{3}{c|}{\textbf{Analisi di RITA}} \\
    \hline 
    \noalign{\vskip 2ex}
    \cline{2-4}
    \multicolumn{1}{c|}{} & Beacon & Tempo connessione & Gravità \\ \hline 
    Information Reply & 0.0\% & 1h 26m 32s & Low \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 26m 32s & Nessuna \\ \hline 
    Timestamp Reply & 0.0\% & 1h 25m 53s & Low \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 25 53s & Nessuna \\ \hline 
    Redirect & 0.0\% & 1h 25m 28s & Low \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 25m 28s & Nessuna \\ \hline  
    Source Quench & 0.0\% & 1h 26m 28s & Low \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 26m 28s & Nessuna \\ \hline  
    Parameter Problem & 0.0\% & 1h 23m 51s & Low \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 23m 51s & Nessuna \\ \hline  
    Time Exceeded & 0.0\% & 1h 24m 46s & Low \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 24m 46s & Nessuna \\ \hline  
    Destination Unreachable & 0.0\% & 1h 23m 51s & Low \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 23m 51s & Nessuna \\ \hline  
    Echo solo campi & 0.0\% & 1h 25m 23s& Low \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 25m 23s & Nessuna \\ \hline  
    Echo solo payload & 0.0\% & 1h 9m 17s & Low \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 9m 17s & Nessuna \\ \hline 
    Echo campi+payload & \multicolumn{3}{c|}{no items} \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 34m 45s & Nessuna \\ \hline    
    Ibrido & 85.4\% & 15h 7m 40s & High \\ \hline 
    %\multicolumn{1}{c|}{} & 75.1\% & 15h 7m 40s & High \\ \hline  
\caption{Invio di 37 KB una volta sola} 
\label{tab:test1:rita_icmp:rilevati} 
\end{longtable} 
\end{center} 
Nel \textbf{secondo test} si si inviano due file. 
Il primo contiene un quantità di dati pari a \textbf{37 KB} %(37201 bytes = 37.201 KB) %Testo AG:
mentre il secondo contiene \textbf{216 KB}. %(215639 bytes=215.639 KB) %Testo main: 
Il test è stato fatto siccome il precedente mandava solo un singolo file; 
quando normalmente un attaccante cercerebbe di esfiltrarne un numero maggiore. 
In quest testi ci si è serviti solo dei Covert Channel ICMP Echo; 
principalmente perchè ripsetto al test precedente davano risutlati migliori rispetto agli altri. 
Inoltre le Echo Request/Reply sono i messaggi ICMP più comuni e utilizzati. 
\vspace{2ex} \newline 
I risultati [Tabella \ref{tab:test2:rita_icmp:rilevati}] sono che il Covert Channel che utilizza solo i campi 
per l'esfiltrazione ha dei dati di esecuzione elevati rispetto agli altri. 
Di conseguenza RITA gli assegnata una gravità alta sebbene il tasso di beaconing è relativamente contenuto. 
Invece il Covert Channel che sfrutta solamente il payload ha una gravita media ma dei tempi di comunicazioni simili a quelli precedenti. 
Infine il Covert Channel che utilizza sia i campi che il payload risulta il migliore: ha una gravità media tuttavia 
il suo tempo di esecuzione e notevolemnte minore rispetto a quello delli altri due. 
Tuttavia fra i tre, ha il tasso di beaconinmg maggiore. 
\begin{center} 
\begin{longtable}{|c|c|c|c|} 
    \hline
    \textbf{Covert Channel} & \multicolumn{3}{c|}{\textbf{Analisi di RITA}} \\
    \hline 
    \noalign{\vskip 2ex}
    \cline{2-4}
    \multicolumn{1}{c|}{} & Beacon & Tempo connessione & Gravità \\ \hline 
    Echo solo campi & 12.20\% & 9h 30m 34s & High \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 25m 23s & Nessuna \\ \hline 
    Echo solo payload & 10.7\% & 7h 42m 49s & Medium \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 1h 9m 17s & Nessuna \\ \hline 
    Echo campi+payload & 19.6\% & 4h 30m 44s & Medium \\ \hline 
    %\multicolumn{1}{c|}{} & 0.0\% & 34m 45s & Nessuna \\ \hline 
\caption{Invio di 37KB e poi 216KB} 
\label{tab:test2:rita_icmp:rilevati} 
\end{longtable} 
\end{center} 
Nel \textbf{terzo test} si sono mandati \textbf{1.5 MB} di dati senza delay, \textbf{3 MB} di dati senza delay 
e entrambi i dati precedenti senza delay (\textbf{4.5 MB}). 
Il Covert Channel utilizzato è quello che utilizza l'ICMP Echo sia con i campi che con il payload.
%1550958 bytes = 1.5 MB
%3715385 bytes = 3.7 MB
\vspace{1ex} \newline
Il risultato [Tabella \ref{tab:test3:rita_icmp:rilevati}] è che non vi è alcuna voce nel database di RITA riguardante lo scambio di messaggi. 
Ciò può risultare positivo, siccome RITA non ha rilevato anomalie apparenti, tuttavia mandare una 
notevole quantità di dati in un canale viene notata.  
\begin{center} 
\begin{longtable}{|c|c|c|c|} 
    \hline
    \textbf{Covert Channel} & \multicolumn{3}{c|}{\textbf{Analisi di RITA}} \\
    \hline 
    \noalign{\vskip 2ex}
    \cline{2-4}
    \multicolumn{1}{c|}{} & Beacon & Tempo connessione & Gravità \\ \hline 
    1.5 MB no delay & \multicolumn{3}{c|}{No items} \\ \hline  %Solo password file senza delay
    3 MB no delay & \multicolumn{3}{c|}{No items} \\ \hline %Solo main file senza delya
    1.5+3 MB no delay & \multicolumn{3}{c|}{No items}  \\ \hline %Main e password senza delay
\caption{Invio di grandi dati} 
\label{tab:test3:rita_icmp:rilevati} 
\end{longtable} 
\end{center} 
Nel \textbf{quarto test} si inviano i dati, la cui quantità risulterà di \textbf{1.5 MB}, tramite dei delay. 
Nel primo caso si dividono i dati in blocchi da al massimo 16KB, e poi si aspettano 3 minuti prima di inviare un altro blocco. 
Nel secondo caso invece si manda l'intero documento e poi si aspetta un ora pima si mandare ulteriori documenti. 
\vspace{2ex} \newline 
I risultati [Tabella \ref{tab:test4:rita_icmp:rilevati}] sono che nel primo caso RITA rileva un tasso di 
beaconing del 97.7\% ed una gravità alta. 
Ciò è dovuto al fatto che i dati sono stati mandati in blocchi regolari e con un delay quasi costante. 
Nel secondo caso invece RITA non rileva nulla, sebbene si sia mandata una grande quantità di dati, probabilmente 
perchè il tempo di attesa è stato abbastanza lungo. 
\begin{center} 
\begin{longtable}{|c|c|c|c|} 
    \hline
    \textbf{Covert Channel} & \multicolumn{3}{c|}{\textbf{Analisi di RITA}} \\
    \hline 
    \noalign{\vskip 2ex}
    \cline{2-4}
    \multicolumn{1}{c|}{} & Beacon & Tempo connessione & Gravità \\ \hline 
    
    \hline 
    1.5 MB +3 min delay & 97.70\% & 47s & High \\ \hline 
    1.5 MB +wait 1 hour & 9.10\% & 3m 0s & None \\ \hline 
\caption{Invio di grandi dati con del delay} 
\label{tab:test4:rita_icmp:rilevati} 
\end{longtable} 
\end{center}  
%Secondo test con AG: 3715385 bytes si manfda il file letto come bytes
%Secondo test con main: 1550958 bytes si manfda il file letto come bytes
%
%1550958/4096=379 blocchi
%
%379*5=1895 minuti=31 ore
%
%1550958/8192=190
%190*5=950 minuti=15 ore 
%
%1550958/16384=95
%95*5=475 minuti=7 ore
%95*3=285 minuti=4.75 ore