Un \textbf{Covert Channel} è un attacco che permette (in ambienti ritenuti sicuri) la capacità di comunicare e/o trasferire dati in maniera non autorizzata e non voluta.  
%Ciò avverrà fra processi e/o entità comunicanti senza che vengano rivelati ed evitando (se non violando) le normali politiche di sicurezza. 
Solitamente operano al di fuori degli usuali meccanismi di comunicazioni sfruttando vulnerabilità o comportamenti non previsti nei sistemi. 
%Non usando i normali protocolli e/o canali di comunicazione (es network sockets, emails) 
%ciò gli permette di non generare segnali di un uso improprio del sistema. 
Ciò gli permette di non generare segnali di un uso improprio del sistema ed inoltre, 
nascondendosi all'interno dei normali processi del sistema, sono difficili da rilevare e/o identificare. 
La loro esistenza quindi rappresenterà un problema che spesso rimane non notato dagli amministratori o dai tipici strumenti di monitoraggio. 
Da notare inoltre che qualsiasi risorsa condivisa può essere utilizzata come canale nascosto. 
Questo permetterà ai Covert Channel di esistere in qualsiasi sistema. 
%In aggiunta, qualsiasi risorsa condivisa può essere utilizzata per la creazione di un canale nascosto, 
%e di conseguenza possono esistere in qualunque sistema. 
%Questi attacchi sono un problema significativo in tutti quegli ambienti dove una fuoriuscita di informazioni può avere conseguenze gravi (es ambienti militari, governativi,\dots).  
%Siccome l'suo imporprio che si fà di queste risorse: porta alla fuoriuscita (o scambio) dei dati. 
\vspace{2ex} \newline  
%\textbf{Stealthiness} (furtività)
Siccome un covert channel deve poter aggirare i controlli in maniera nascosta;  
avrà bisogno di alcune caratteristiche. 
tuttavia, uno dei maggiori problemi nell'implementazione di un canale nascosto è l'uso eccessivo delle risorse. 
La necessità cardine, è quella di riuscire a trasmettere informazioni mantenendo conforme lo stato del sistema; 
così da rendere il canale \textbf{indistinguibile} rispetto alle altre risorse presenti nel sistema. 
dalla risorsa sfruttata e di conseguenza invisibili ai sistemi di monitoraggio. 
In generale il canale è incorporato in operazioni di sistema legittime per poter mascherare la trasmissione dei dati. 
%(e.g carico della CPU, accesso alla memoria, traffico della rete, metadati del file systema). 
%
%    Di solilto si sfruttano servizi e/o risorse già presenti e quindi non sospette; 
%    uno dei maggiori problemi nell'implementazione di un canale nascosto è il “rumore” che potrebbe attirare l'attenzione 
%    da parte degli amministratori (es. se si sfruttano eccessivamente le risorse). 
%    La necessità è quella di riuscire a trasmette attraverso un canale nascosto mantenendo conforme e inalterato il 
%    funzionamento della risorsa utilizzata così da rendersi “indistinguibili” dalla risorsa autorizzata e di 
%    conseguenza invisibili ai sistemi di monitoraggio.
%    Per evitare la rilevazione, il canale è incorporato in operazioni di sistema legittime per poter mascherare la trasmissione dei dati. 
%    (e.g carico della CPU, accesso alla memoria, traffico della rete, metadati del file systema). 
%\vspace{2ex} \newline
%Per evitare la presenza dei Covert Channel, bisogna quindi prestare attenzione all'\textbf{uso involontario delle risorse} 
%ed evitare che esse possano essere usate (in maniere non previste) per la comunicazione. %(e.g memoria condivisa, uso della CPU, attributi dei file)
%Questo perchè, permetterebbero lo scambio non non autorizzato di informazioni; 
%potenzialmente violando le politiche di sicurezza; 
%nelle quali i principali requisiti sono: la confidenzialità dei dati, l'integrità di quest'ultimi o la disponibilità delle risorse e/o servizi. 
%Di conseguenza un metodo per la \textbf{rilevazione delle violazioni} delle politiche di sicurezza, risulta necessaria. 
\vspace{1ex} \newline
\begin{center} 
\begin{longtable}{|p{0.4\textwidth}|p{0.4\textwidth}|} 
    \hline
    \textbf{Caratteristica} & \textbf{Descrizione} \\
    \hline
    Furtività & 
        Evitare di attirare le attenzioni sia degli amministratori che degli strumenti utilizzati per il rilevamento degli attacchi. 
        %Si devono poter aggirare i controlli in maniera nascosta.
    \\
    \hline 
    Capacità di trasmissione &
        Espressa in termini di \textbf{throughput} ($\frac{dati}{tempo}$). 
        Più dati il canale trasmette per un determinato intervallo di tempo, maggiore sarà il rischio che venga scoperto 
        siccome potrebbe rendere anomalo il funzionamento delle altre risorse.
        %e un valore maggiore permetterà di scambiare un maggior numero di informazioni. 
        %Tuttavia se la trasmissione risultasse anomala o eccessiva, potrebbe essere rilevata siccome un eccessivo carico di informazioni, 
        %potrebbe rendere anomalo il funzionamento delle risorse.
        %Quindi se la lunghezza di banda (Bandwith) risultasse limitata;  
        %Quindi il throughput è inversamente correlato alla segretezza di un canale: 
        %più dati un canale trasmette in un determinato periodo di tempo, maggiore è il rischio che il canale venga scoperto
    \\
    \hline
    Uso delle risorse &
        Un uso delle risorse improprio o sproporzionato aumenta il rischio di essere individuati. 
        Siccome il canale potrebbe andare in conflitto con le risorse legittime presenti nel sistema. 
        %I Covert channels sfruttano le risorse del sistema (e.g memoria cxondivisa, uso della CPU, attributi dei file) 
        %in maniere non previste per la comunicazione. 
    \\
    \hline
    Rumore &
        Sfruttando servizi e/o risorse già presenti nel sistema, si potrebbe alterare il loro funzionamento. 
        L'alterazione del comportamento della risorsa o del servizio sfruttato potrebbe attirare l'attenzione da parte degli amministratori. 
    \\
    \hline
    Indistinguibilità & 
        Si ha la necessità di riuscire a trasmette i dati sempre mantenendo conforme e inalterato il 
        funzionamento della risorsa utilizzata. 
        L'obbietivo è quello di rendersi indistinguibili dalla risorsa autorizzata e di conseguenza invisibili ai sistemi di monitoraggio.
    \\
    \hline
    %Violazione delle politiche di sicurezza &
    %    Permettono lo scambio non autorizzato di informazioni, potenzialmente violando 
    %    i requisiti di confidenzialità, di integrità o quelli di disponibilità.  
    %\\
    %\hline 
\caption{Caratterisitche di un Covert Channel} 
\label{tabella:caratteristiche:covert:channel} 
\end{longtable} 
\end{center}   



\subsection{Implementazione}  
In un Covert Channel ICMP verranno utilizzati messaggi ICMP (di solito richieste e risposte Eco) per nascondere 
i dati all'interno di campi che normalmente vengono ignorati o non monitorati. 
Il canale sarà possibile siccome il protocollo ICMP (Internet Control Message Protocol) consente agli attaccanti di trasferire dati 
aggirando le politiche di sicurezza ed eludendo il rilevamento.
Ciò è possibile siccome è un protocollo che viene utilizzato, in sinergia con il protocollo IP, per la diagnostica della rete, 
per la segnalazione di errori, per ottenere informazioni tramite la messagistica di controllo e per la risoluzione dei problemi nelle reti. 
Permette quindi di informare il mittente sui problemi di rete %Segnalazione errori %(ad esempio, destinazione non raggiungibile, perdita di pacchetti) 
, aiutare nella risoluzione dei problemi di rete %Diagnostica di rete %utilizzando strumenti come ping e traceroute 
e gestisce la congestione della rete oltre gli aggiornamenti di routing (in alcuni casi) %Messaggistica di controllo
%Opera a livello rete (livello 3 modello ISO/OSI). 
\vspace{2ex} \newline 
%Molti firewall e dispositivi di sicurezza consentono il traffico ICMP per la diagnostica della rete.
%I pacchetti ICMP possono trasportare dati (payload) nascosti senza destare sospetti.
%I sistemi di sicurezza tradizionali si concentrano sul traffico TCP/UDP, trascurando ICMP.
Sebbene sa essenziale per la diagnostica di rete e la segnalazione degli errori, può essere comunque utilizzato in 
modo improprio per degli attacchi o per la ricognizione della rete (network reconnaissance). 
%Gli aggressori possono utilizzare ICMP per attacchi DDoS, di ricognizione, di esfiltrazione di dati o di covert channel.
%Le regole del firewall e la limitazione della velocità aiutano a bilanciare usabilità e sicurezza. 
%Data la sua necessita per la diagnostica di rete e la segnalazione degli errori, 
%può essere utilizzato in modo improprio per mettere a segno degli attacchi o per studiare la rete (ricognizione della rete). %network reconnaissance 
%Siccome ICMP è spesso consentito nei firewall, gli aggressori lo utilizzano per aggirare le politiche di sicurezza. 
Questi messaggi verranno usati per creare una comunicazione fra una vittima e il suo attaccante, 
in cui potrebbero essere presenti in caso dei proxy intermedi. 
\vspace{3ex} \newline
Nei seguenti capitoli verrà illustrato come può essere sfruttato per la creazione di un Covert Channel.   
%un attacco che permette (in ambienti ritenuti sicuri) la capacità di comunicare e/o trasferire dati in maniera non autorizzata e non voluta. 
%L'attacco opera al di fuori degli usuali meccanismi di comunicazioni %Inoltre sfruttando vulnerabilità o comportamenti non previsti nei sistemi,  
%e per questo risulta difficile da rilevare e/o identificare. 
%Sia dagli amministratori che dai tipici strumenti di monitoraggio. 
%Infine, siccome qualsiasi risorsa condivisa può essere utilizzata per la sua creazione, può esistere in qualunque sistema. 
Principalmente le risorse condivise, e manipolate, saranno i pacchetti ICMP e i dati verranno codificati all'interno dei campi presenti. 
%Il mittente manipola una risorsa di sistema condivisa (osservabile dal destinatario) per codificare i dati segreti (eg tramite il tempo o la memoria).  
%\textbf{Codifica dei dati}: gli aggressori incorporano messaggi nascosti all'interno di pacchetti ICMP, come richieste di Eco (ping) o risposte di Eco.
%\textbf{Evasione del firewall}: poiché ICMP è spesso consentito nei firewall, gli aggressori lo utilizzano per aggirare le politiche di sicurezza.
%\textbf{Comunicazione furtiva}: malware e botnet utilizzano poi ICMP per comunicare segretamente con un attaccante remoto.
Altre codifiche, che non includono l'insserimento di onfromazioni nei campi, saranno quelle relative alla distanza di tempo 
oppure alla tipologia di messaggio ricevuto. 
Nel primo caso in base alla distanz adi tempo fra un pacchetto e l'altro, viene codificato l'informazione. 
Nel secondo caso la codifica dei dati verrà associata alla particlare tipologia di messaggio ricevuto.



%Nelle prossime pagine, si analizzeranno le varie tipologie di messaggi 
%(divise in \textbf{Messaggi di errore} \footnote{segnalano problemi nella comunicazione di rete} e \textbf{Messaggi informativi} \footnote{utilizzati per scopi diagnostici e di controllo})
%che il protocollo può mandare per definire un canale di comunicazione nascosto per uno scambio di informaizoni (non consentito). 

\subsubsection{Categorie di Covert Channel implementate}  
\begin{itemize}
    \item Timing Covert Channel (Temporizzazione): \newline 
    %I covert channel di temporizzazione sono metodi di comunicazione che permettono ad un osservatore (un umano o un processo) di acquisire informazioni attraverso il cambiamento del tempo di rispostadi una risorsa. 
    Sfruttano gli intervalli di tempo o l'ordine degli eventi per codificare le informazioni (e.g. ritardi fra i pacchetti di rete,\dots). 
    Qualsiasi metodo che utilizza un orologio (o una misurazione del tempo) per segnalare il valore può implementarlo. 
    \item Storage Covert Channel (Archiviazione): \newline 
    Implicano la scrittura di dati su un'area di memoria condivisa accessibile da entrambi i processi. 
    I veicoli saranno tutte quelle risorse che consentono la scrittura (diretta o indiretta) da parte di un processo e 
    la lettura (diretta o indiretta) da parte di un altro.Un processo scrive su una risorsa condivisa, mentre un altro processo legge da essa. 
    %Possono essere quindi utilizzati da processi all'interno di un singolo computer o tra più computer in una rete.
    %\begin{esempio}
    %    Variare deliberatamente il tempo fra delle azioni (es trasmissione di network packet, patter di uso della CPU) 
    %    oppure codificando dati nella temporalizzazione dell'esecuzione dei processi o delay di risposta. 
    %\end{esempio}
    %\vspace{1ex} \noindent
    %Coinvolgono quindi la scrittura di dati su un'area di memoria condivisa accedibile da entrambi i processi (e.g attributi del file, i bit di memoria, gli stati della cache,\dots).
    %Di conseguenza, i veicoli sono tutte le risorse che consentono la scrittura (diretta o indiretta) da parte di un processo e la lettura (diretta o indiretta) da parte di un altro.
    \item Behavioral Covert Channel (Comportamento): \newline 
    I canali nascosti comportamentali operano trasmettendo dati in base all'avvenimento di diversi eventi. 
    %di processi, sistemi e applicazioni, generalmente suddividendo e trasmettendo i dati in pacchetti più piccoli. 
\end{itemize}



